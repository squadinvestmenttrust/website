<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Waitlist</title>
    <style>
        body {
            margin: 0;
            background-color: #0000FF;
            color: white;
            font-family: 'Helvetica Neue', sans-serif;
            overflow: hidden;
        }

        #container {
            text-align: center;
            padding: 20px;
        }

        #hero-img {
            max-width: 80%;
            height: auto;
            margin: 2rem auto;
            display: block;
        }

        .dos-text {
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.5rem;
            margin-top: 1rem;
        }

        #product-img {
            max-width: 60%;
            display: block;
            margin: 2rem auto;
            image-rendering: pixelated;
        }

        #product-info {
            max-width: 600px;
            text-align: left;
            margin: auto;
            font-size: 1.2rem;
            white-space: pre-wrap;
        }

        #waitlist-box {
            border: 2px solid white;
            display: inline-block;
            padding: 1rem 2rem;
            margin-top: 2rem;
            cursor: pointer;
            transition: all 0.5s ease;
            font-weight: bold;
        }

        #lockout {
            font-family: 'Courier New', Courier, monospace;
            font-size: 2rem;
            display: none;
            text-align: center;
            padding-top: 20vh;
        }
    </style>
</head>
<body>
    <div id="container">
        <img id="hero-img" src="https://i.ibb.co/DP0MHnjM/IMG-6365.jpg" alt="Waitlist Hero">
        <div class="dos-text" id="welcome"></div>
        <img id="product-img" src="" style="display: none;">
        <div id="product-info"></div>
        <div id="waitlist-box">join the waitlist.</div>
    </div>
    <div id="lockout"></div>

    <script>
        const welcomeText = "welcome to waitlist.";
        let waitlistBox = document.getElementById('waitlist-box');
        let lockoutDiv = document.getElementById('lockout');
        let welcomeDiv = document.getElementById('welcome');
        let productImg = document.getElementById('product-img');
        let productInfo = document.getElementById('product-info');
        let moveCount = 0;
        const waitlistMessages = [
            "Product: ",
            "Materials: ",
            "Price: ",
            "Wait: "
        ];
        const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT6aU1_jB0juldfdNBs-KX3XLLqOuAoZDNpg_znvr_x1ToUAariHKo2Gz-REVye58V_nenvXETUOTZk/pub?output=csv";

        // Typewriter welcome message
        let index = 0;
        function typeWelcome() {
            if (index < welcomeText.length) {
                welcomeDiv.innerHTML += "<span class='block'>â–ˆ</span>" + welcomeText.charAt(index);
                index++;
                setTimeout(() => {
                    welcomeDiv.innerHTML = welcomeText.substring(0, index);
                    typeWelcome();
                }, 100);
            } else {
                setTimeout(loadData, 500);
            }
        }

        // Simulate image loading top-down
        function loadImageProgressively(url) {
            let chunks = 30;
            let i = 1;
            let interval = setInterval(() => {
                productImg.style.display = 'block';
                productImg.style.clipPath = `inset(0 0 ${100 - (i / chunks) * 100}% 0)`;
                i++;
                if (i > chunks) clearInterval(interval);
            }, 50);
            productImg.src = url;
        }

        function loadData() {
            fetch(csvUrl)
                .then(res => res.text())
                .then(text => {
                    const rows = text.trim().split('\n');
                    const data = rows.map(r => r.split(','));
                    const productName = data[0][1];
                    const productImage = data[1][1];
                    const material = data[2][1];
                    const price = data[3][1];
                    const wait = data[4][1];

                    loadImageProgressively(productImage);
                    productInfo.innerHTML = `${waitlistMessages[0]}${productName}\n${waitlistMessages[1]}${material}\n${waitlistMessages[2]}${price}\n${waitlistMessages[3]}${wait}`;
                });
        }

        let positions = ["translate(50px, 0)", "translate(-50px, 50px)"];

        waitlistBox.addEventListener('click', () => {
            moveCount++;
            if (moveCount <= 2) {
                waitlistBox.style.transform = positions[moveCount - 1];
            } else {
                document.getElementById('container').style.display = 'none';
                lockoutDiv.style.display = 'block';
                let seconds = 900;
                let timer = setInterval(() => {
                    lockoutDiv.innerText = `You are locked out of waitlist for ${seconds} seconds`;
                    seconds--;
                    if (seconds < 0) {
                        clearInterval(timer);
                        location.reload();
                    }
                }, 1000);
            }
        });

        typeWelcome();
    </script>
</body>
</html>
